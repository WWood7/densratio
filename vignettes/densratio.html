<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Koji MAKIYAMA (@hoxo_m)" />

<meta name="date" content="2017-01-26" />

<title>An R Package for Density Ratio Estimation</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">An R Package for Density Ratio Estimation</h1>
<h4 class="author"><em>Koji MAKIYAMA (<span class="citation">@hoxo_m</span>)</em></h4>
<h4 class="date"><em>2017-01-26</em></h4>



<div id="overview" class="section level2">
<h2>1. Overview</h2>
<p><strong>Density ratio estimation</strong> is described as follows: for given two data samples <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> from unknown distributions <span class="math inline">\(p(x)\)</span> and <span class="math inline">\(q(y)\)</span> respectively, estimate</p>
<p><span class="math display">\[
w(x) = \frac{p(x)}{q(x)}
\]</span></p>
<p>where <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are <span class="math inline">\(d\)</span>-dimensional real numbers.</p>
<p>The estimated density ratio function <span class="math inline">\(w(x)\)</span> can be used in many applications such as anomaly detection [1] and covariate shift adaptation [2]. Other useful applications about density ratio estimation were summarized by Sugiyama et al. (2012) [3].</p>
<p>The package <strong>densratio</strong> provides a function <code>densratio()</code>. The function outputs an object that has a function to estimate density ratio.</p>
<p>For example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">3</span>)
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">200</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">1</span>/<span class="dv">8</span>)
y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">200</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">1</span>/<span class="dv">2</span>)

<span class="kw">library</span>(densratio)
result &lt;-<span class="st"> </span><span class="kw">densratio</span>(x, y)</code></pre></div>
<p>The function <code>densratio()</code> estimates the density ratio of <span class="math inline">\(p(x)\)</span> to <span class="math inline">\(q(y)\)</span>, <span class="math display">\[
w(x) = \frac{p(x)}{q(y)} = \frac{\rm{Norm}(1, 1/8)}{\rm{Norm}(1, 1/2)}
\]</span> and provides a function to compute estimated density ratio. The <code>result</code> object has a function <code>compute_density_ratio()</code> that can compute the estimated density ratio <span class="math inline">\(\hat{w}(x) \simeq p(x)/q(y)\)</span> for any <span class="math inline">\(d\)</span>-dimensional input <span class="math inline">\(x\)</span> (now <span class="math inline">\(d=1\)</span>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">new_x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dt">by =</span> <span class="fl">0.05</span>)
w_hat &lt;-<span class="st"> </span>result$<span class="kw">compute_density_ratio</span>(new_x)

<span class="kw">plot</span>(new_x, w_hat, <span class="dt">pch=</span><span class="dv">19</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In this case, the true density ratio <span class="math inline">\(w(x) = p(x)/q(y) = \rm{Norm}(1, 1/8) / \rm{Norm}(1, 1/2)\)</span> can be computed precisely. So we can compare <span class="math inline">\(w(x)\)</span> with the estimated density ratio <span class="math inline">\(\hat{w}(x)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">true_density_ratio &lt;-<span class="st"> </span>function(x) <span class="kw">dnorm</span>(x, <span class="dv">1</span>, <span class="dv">1</span>/<span class="dv">8</span>) /<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dv">1</span>, <span class="dv">1</span>/<span class="dv">2</span>)

<span class="kw">plot</span>(true_density_ratio, <span class="dt">xlim=</span><span class="kw">c</span>(-<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Density Ratio&quot;</span>)
<span class="kw">plot</span>(result$compute_density_ratio, <span class="dt">xlim=</span><span class="kw">c</span>(-<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="kw">expression</span>(<span class="kw">w</span>(x)), <span class="kw">expression</span>(<span class="kw">hat</span>(w)(x))), <span class="dt">col=</span><span class="dv">2</span>:<span class="dv">3</span>, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">pch=</span><span class="ot">NA</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAGACAMAAABC/kH9AAAAilBMVEUAAAAAADoAAGYAOjoAOpAAZrYAzQAA/wA6AAA6ADo6AGY6Ojo6OpA6ZrY6kLY6kNtmAABmADpmAGZmZgBmZjpmZmZmtv+QOgCQOjqQOmaQtpCQ2/+2ZgC2Zma2kDq2/7a2///bkDrbkJDb25Db2//b/7bb/9vb////AAD/tmb/25D//7b//9v///8/mjmQAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMHElEQVR4nO2da2OjuBWGya7TZKbb2ml3xtuadpde1gab///3FoGxsWMwEpKO9Op9PiROxqODeSKhG4esJtBk0gdA3ELB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDY1lwRjwhJdhucQA4OiMUHAoUDA4FgxOj4Or9u83isIlJ8HFz7cT98Nvi4tIgJsF1ma3VN9ZgDaIS3NTh1f6RYP3hWUAcDi5Lj0twXecvO7QafHBqODbBdZGtKViD6AQ39fdHKMEHCr7jtM2wBDu9Ckco2GNxHlByKdh+3GCgYDdxQ6Fz69Dw0jPyr35GqfqLUbEUfP3qhGVn5Li5dnfK4ewhBc/jbDZUwce/DWeEq5/2+sVS8M13+yw6I/nr2I8UPI+wBd/PKJUvO+1iKfjmu300z8hp+6oWdRqx+WpftFdd9fW4Ucs83Ve9Yin45rt9dM9IsdrXRfbamF6ftmppR71qf6terfqrMAXPw5fgwxQ371fNcP5tta++7Lq1O9V9/vWjbZtP20tHmoLn4UnwpN/b0M3A6Pjxz6+/NYOi6v3cqcqz7sVpe7kIU/A8wmui63xd/fT/j13TY74ILs+T/xSsy8VrQIKL1b9f6/yv2+9130Sftt+6pplNtC5Xr84Ma5+R6uvfm07Vj192lz5Vsfp923af2cnSJUTBx03TDpeZUtkNk9R0ZXl+xWGSHiEKrvNGZvWuVHYTHc2AuBsec6JDmyAFD+BU5UJCF3z6ZTf4qfp6XXqg4FmELvhmOen0Dy4X6hK84Pr40dfh6suwNlPwHAZWQxW8uNjEBb+9XV+7iUHBgijBb5fXbmJQsCChCi5eds/eQsFzCFTw6Zef18/eQ8FzCFRwufrvYMS7sNhkBSuzreCz4YAE5+vT9rIZi/uiDVFmwxSsBrzFedmI+6KNacw2TkMUrOSeZzW4L9qce8GuDHOxQYhWcGM3ZMHcF72AXnDtuI3uzsifphi+nfuibeFV8KTfG8HcF20LdfX1V4Pnw33RlghVMPdFWyJUwdwXbYmL4PrclQ5FMPdF22EouBsNuzHMfdFC9FqDE8x90Xa4EeywjY5wX3SZZaML0jEJPgwE1+3Sg4s4cU1V5lm2VlPew0WOBcVJchV8/jFEwb73RavGIm9rb7HaP3wHBd8T077ott52C1nlbcb3CPNFxyHY6r7o6j2buLrWfSfu9L8asAbX7eqhA8LZVdnl6y/GM8n23fb6pr9uGFec5ASfurH0aN3s/rGr4OXoX0Fkgm9+dtNGByO47xiXI89TsRxXnPsaCy94Vg22F1ecT02yozY6GMFzrsEW44qTnuDnvWibcaX53CLjC/YaV5rPOl0J5vODRfAm2BEU/ITEBB8368uTJ9MYJj0S7Pghd1ZhDX5CeoL7We1EJjoeNMhRtdHmggsKjgFdwfm1//305nIrcaVJTfBw4dFLXGnSE+w5rjQJCu7HSbwGx4CBYHW74uvU072txpWmsfngV8iC1SaNUt26mMZy4UPBEQ2EzRb81b7M6mkGHytxpUlPsFrwVz3pdAVH1UYbXIPVDEe+TriJRhesboxoetKLOtEU7AuOg5+QsOD/8BocAdqCi/MMx+AmcqdxpUlNcJvbpeleleksNjz6Hazg9v7iZiRcpLSr8sHvYAW39xqdtn/OXp+83VpcaZIT3OYKWNY8a8UV5tEleOy3QWImeNEch15cYUYFx2LYTPDSBpqCvUHB01Cw67jCpCf4uukuiYmO1AT7jyvMo1ESBfsvzhkU7DquMBTsOq4wjwVHNNNBwdNQsOu4wiQouBkpLR8GU7AvTGpwsfTOM524wowLjsSwYRP9zLH69/bOh7GbTCnYE8bX4GJqLktlMjxuVEseueBDooLLtoIOHv1wS5cMr/1nChbG8O7C/klbj+316SwvT9W7lhJZvugUBbcP+5imT2dZ56+swcK4ScLSax2/AYKCPWEueDIJS3F5xhoFy6IrOLEkLOkJTiwJS4qCPceVhYKdxxVlzC+u4MSSkU4IjiWLA2vwFBTsPq4oo4LjaaONpirXaqlh2e0rFOwJA8H5aq8eGr9s9zsFe8JkLvp7+0SzFPJFJytYPXs6hXzRSQpu2ubjZrXv1vPdxxUlTcHNQPhl1z0r3kNcUdIU7DeuKBTsPq4khynBkcx0GAg+bVOZqkxUcL4sS6VmXEnSFDz61HY3cSVJVfCiXP66cSVJU/DSAZJmXEnSFNzOU/qLK0maghNa8E9TsOe4klCwh7iSpCq4aaRX+3zZYCkGwY3BUcHRGDbpZL3sCrWaBL/xPVHB6s6yYuLGUMtxBZlooZEFq4kOJRh/R0eigvsavCxpNAV7wvgaXCyb7qBgTxj2orMUHsqRrGCvcQWhYB9xBUlUcDcXvfSxHBTsCW3B+TnB2cJcdxEInpzngBVc9p2r6h29F/1UcBSGNQUPVvvh701KUvBgBhp+qjJRwZeGGX6qcrKPRcG24spBwRRMwcvjyvFccAyGtQUn8+Sz6T5WNFXYyVTljD8DCvaEm7no8Ryk8eSLpuApnt7+QMGecLWa9Oz2Bwr2BJcLx5gjOALDFDwGBfuJKwYF+4krxTO/FOy1OPtQsKe4UlCwp7hSPBUciWEKHoGCPcWVgoI9xZWCgj3FlYKCPcUVQomjYB9xhZgrOHjDFPwYCvYVVwgK9hVXhhl+KdhncbahYG9xZZgjOA7DFPwQCvYWV4RWGgV7iSsCBfuLKwIF+4srwqxLcP+OsA1T8APmVWAK9licXSjYY1wJKNhjXAko2GNcATpjFOwnrgAzK3DzlggMU/Bn5gqOogpT8CfmttB1FFMdFPwJbcFBG6bgT2gIjqAKU/A9Z1sU7Cmud3QqcASGKfgeXcGB746m4Dv0/LaGVWrwYA1T8B3nQfBswaEbpuBbdCtw/24KdlucNWbPYg0J2TAF36DdQLd0gsM0TMEDDodur46m36ANOxJ82j5JORyg4IOx30tHK0DFbgRfnqpUjj1eKTTBh6tefb/df3vrywgKJ4LVE2jPFCOPSLsr7i0gND5oBJ/AieDxxP8j+aKlz8gAjY95h/SRX7k543MP320NJq5wdQ0+V+ForsGwOOpF909tGH1IKQV7guNgcCgYHAoGh4LBERNMPCEk2HnhLo4X+jApGPwwKRj8MCkY/DApGPwwKRj8MCkY/DApGPwwKRj8MDm3CA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDI5jwdXXsVwAJpRZ9rKzWF6H3WM8p0EYuTnPmML0o7sVfNyMJnswoGw+YmndsN1jVH6bQyyyV5tl1kVzjGYf3angciKbhz7d7cm53TNn+Rgbqnd1j21htdDjZq0+v8lHdym4zNalxc/p4szZPsZrufavJeEJrj+lelhE9WVnucQOJ4Jz+4UW4TXRdk9eVynsVw0XgkdTICwo0axICnYhuLTcx2o5bUcTK0wQkeB4mmj79bcr1uRv243goh8JBt/Jqh0ILtz4PZ8ATSKqwW6GSfYFX3IR2aNTa3SgEQl2NNFhW3D17qD+5s3ld5CmTIOYBJvP101iWXDR3YFv+UDzpkijhoGLDeBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOBQMDgWDQ8HgUDA4FAwOBYNDweBQMDgUDA4Fg0PB4FAwOKkLVgkD2ixUqKQuWN1VXZgkN4mF1AXX5Q+/fti/qTwckhdc5y5SHoUDBZf2c6aERPKCT9tvLlIZBkPygovV70bZa2IhdcHHzXc32UhDIXXBXQIq4G5W6oLhoWBwKBgcCgaHgsGhYHAoGBwKBoeCwaFgcCgYHAoGh4LBoWBwKBgcCgaHgsGhYHAoGBwKBoeCwaFgcCgYHAoG5w8y2TgUbVwNhgAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="how-to-install" class="section level2">
<h2>2. How to Install</h2>
<p>You can install the <strong>densratio</strong> package from <a href="https://cran.r-project.org/web/packages/densratio/index.html">CRAN</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;densratio&quot;</span>)</code></pre></div>
<p>You can also install the package from <a href="https://github.com/hoxo-m/densratio">GitHub</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>) <span class="co"># If you have not installed &quot;devtools&quot; package</span>
devtools::<span class="kw">install_github</span>(<span class="st">&quot;hoxo-m/densratio&quot;</span>)</code></pre></div>
<p>The source code for <strong>densratio</strong> package is available on GitHub at</p>
<ul>
<li><a href="https://github.com/hoxo-m/densratio" class="uri">https://github.com/hoxo-m/densratio</a>.</li>
</ul>
</div>
<div id="details" class="section level2">
<h2>3. Details</h2>
<div id="basics" class="section level3">
<h3>3.1. Basics</h3>
<p>The package <strong>densratio</strong> provides a function <code>densratio()</code>. The function outputs an object that has a function to estimate density ratio.</p>
<p>For data samples <code>x</code> and <code>y</code>,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(densratio)

x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">200</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">1</span>/<span class="dv">8</span>)
y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">200</span>, <span class="dt">mean =</span> <span class="dv">1</span>, <span class="dt">sd =</span> <span class="dv">1</span>/<span class="dv">2</span>)

result &lt;-<span class="st"> </span><span class="kw">densratio</span>(x, y)</code></pre></div>
<p>Here, <code>result$compute_density_ratio()</code> is the function to compute estimated density ratio.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">new_x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dt">by =</span> <span class="fl">0.05</span>)
w_hat &lt;-<span class="st"> </span>result$<span class="kw">compute_density_ratio</span>(new_x)

<span class="kw">plot</span>(new_x, w_hat, <span class="dt">pch=</span><span class="dv">19</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="methods" class="section level3">
<h3>3.2. Methods</h3>
<p><code>densratio()</code> has <code>method</code> argument that you can pass <code>&quot;uLSIF&quot;</code> or <code>&quot;KLIEP&quot;</code>.</p>
<ul>
<li><p><strong>uLSIF</strong> (unconstrained Least-Squares Importance Fitting) is the default method. This algorithm estimates density ratio by minimizing the squared loss. You can find more information in Hido et al. (2011) [1].</p></li>
<li><p><strong>KLIEP</strong> (Kullback-Leibler Importance Estimation Procedure) is the anothor method. This algorithm estimates density ratio by minimizing Kullback-Leibler divergence. You can find more information in Sugiyama et al. (2007) [2].</p></li>
</ul>
<p>The both methods assume that density ratio are represented by linear model</p>
<p><span class="math display">\[
w(x) = \alpha_1 K(x, c_1) + \alpha_2 K(x, c_2) + ... + \alpha_b K(x, c_b)
\]</span></p>
<p>where</p>
<p><span class="math display">\[
K(x, c) = \exp\left(-\frac{\|x - c\|^2}{2 \sigma ^ 2}\right)
\]</span></p>
<p>is the Gaussian RBF.</p>
<p><code>densratio()</code> performs two main jobs:</p>
<ul>
<li>First, decide kernel parameter <span class="math inline">\(\sigma\)</span> by cross validation.</li>
<li>Second, find the optimal kernel weights <span class="math inline">\(\alpha_i\)</span> (in other words, find the optimal coefficients of the linear model).</li>
</ul>
<p><span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\alpha_i\)</span> are saved into result objects of <code>densratio()</code>, and used to compute estimated density ratio in <code>compute_density_ratio()</code>.</p>
</div>
<div id="result-and-arguments" class="section level3">
<h3>3.3. Result and Arguments</h3>
<p>You can <code>print()</code> result objects of <code>densratio()</code> to see information. Moreover, you can change some conditions to specify arguments of <code>densratio()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(result)</code></pre></div>
<pre><code>## 
## Call:
## densratio(x = x, y = y, method = &quot;uLSIF&quot;)
## 
## Kernel Information:
##   Kernel type:  Gaussian RBF 
##   Number of kernels:  100 
##   Bandwidth(sigma):  0.1 
##   Centers:  num [1:100, 1] 1.007 0.752 0.917 0.824 0.7 ...
## 
## Kernel Weights(alpha):
##   num [1:100] 0.4044 0.0479 0.1736 0.125 0.0597 ...
## 
## Regularization Parameter(lambda):  0.1 
## 
## The Function to Estimate Density Ratio:
##   compute_density_ratio()</code></pre>
<ul>
<li><strong>Kernel type</strong> is fixed by Gaussian RBF.</li>
<li><strong>Number of kernels</strong> is the number of kernels in the linear model. You can change by setting <code>kernel_num</code> argument. In default, <code>kernel_num = 100</code>.</li>
<li><strong>Bandwidth(sigma)</strong> is the Gaussian kernel bandwidth. In default, <code>sigma = &quot;auto&quot;</code>, the algorithms automatically select the optimal value by cross validation. If you set <code>sigma</code> a single number, it will be used. If you set a numeric vector, the algorithms select the optimal value in them by cross validation.</li>
<li><strong>Centers</strong> are centers of Gaussian kernels in the linear model. These are selected at random from the data sample <code>x</code> underlying a numerator distribution <span class="math inline">\(p(x)\)</span>. You can find the whole values in <code>result$kernel_info$centers</code>.</li>
<li><strong>Kernel weights</strong> are the alpha parameters in the linear model. They have been optimaized by the algorithms. You can find the whole values in <code>result$alpha</code>.</li>
<li><strong>The funtion to estimate density ratio</strong> is named <code>compute_density_ratio()</code>.</li>
</ul>
</div>
</div>
<div id="multi-dimensional-data-samples" class="section level2">
<h2>4. Multi Dimensional Data Samples</h2>
<p>So far, the input data samples <code>x</code> and <code>y</code> were one dimensional. <code>densratio()</code> allows to input multidimensional data samples as <code>matrix</code>.</p>
<p>For example,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(densratio)
<span class="kw">library</span>(mvtnorm)

<span class="kw">set.seed</span>(<span class="dv">71</span>)
x &lt;-<span class="st"> </span><span class="kw">rmvnorm</span>(<span class="dv">300</span>, <span class="dt">mean =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">sigma =</span> <span class="kw">diag</span>(<span class="dv">1</span>/<span class="dv">8</span>, <span class="dv">2</span>))
y &lt;-<span class="st"> </span><span class="kw">rmvnorm</span>(<span class="dv">300</span>, <span class="dt">mean =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">sigma =</span> <span class="kw">diag</span>(<span class="dv">1</span>/<span class="dv">2</span>, <span class="dv">2</span>))

result &lt;-<span class="st"> </span><span class="kw">densratio</span>(x, y)
result</code></pre></div>
<pre><code>## 
## Call:
## densratio(x = x, y = y, method = &quot;uLSIF&quot;)
## 
## Kernel Information:
##   Kernel type:  Gaussian RBF 
##   Number of kernels:  100 
##   Bandwidth(sigma):  0.316 
##   Centers:  num [1:100, 1:2] 1.178 0.863 1.453 0.961 0.831 ...
## 
## Kernel Weights(alpha):
##   num [1:100] 0.145 0.128 0.138 0.187 0.303 ...
## 
## Regularization Parameter(lambda):  0.1 
## 
## The Function to Estimate Density Ratio:
##   compute_density_ratio()</code></pre>
<p>Also in this case, we can compare the true density ratio with the estimated density ratio.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">true_density_ratio &lt;-<span class="st"> </span>function(x) {
  <span class="kw">dmvnorm</span>(x, <span class="dt">mean =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">sigma =</span> <span class="kw">diag</span>(<span class="dv">1</span>/<span class="dv">8</span>, <span class="dv">2</span>)) /
<span class="st">    </span><span class="kw">dmvnorm</span>(x, <span class="dt">mean =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">sigma =</span> <span class="kw">diag</span>(<span class="dv">1</span>/<span class="dv">2</span>, <span class="dv">2</span>))
}

N &lt;-<span class="st"> </span><span class="dv">20</span>
range &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dt">length.out =</span> N)
input &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(range, range)
w_true &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">true_density_ratio</span>(input), <span class="dt">nrow =</span> N)
w_hat &lt;-<span class="st"> </span><span class="kw">matrix</span>(result$<span class="kw">compute_density_ratio</span>(input), <span class="dt">nrow =</span> N)

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">contour</span>(range, range, w_true, <span class="dt">main =</span> <span class="st">&quot;True Density Ratio&quot;</span>)
<span class="kw">contour</span>(range, range, w_hat, <span class="dt">main =</span> <span class="st">&quot;Estimated Density Ratio&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The dimensions of <code>x</code> and <code>y</code> must be same.</p>
</div>
<div id="references" class="section level2">
<h2>5. References</h2>
<p>[1] Hido, S., Tsuboi, Y., Kashima, H., Sugiyama, M., &amp; Kanamori, T. <strong>Statistical outlier detection using direct density ratio estimation.</strong> Knowledge and Information Systems 2011.</p>
<p>[2] Sugiyama, M., Nakajima, S., Kashima, H., von Bünau, P. &amp; Kawanabe, M. <strong>Direct importance estimation with model selection and its application to covariate shift adaptation.</strong> NIPS 2007.</p>
<p>[3] Sugiyama, M., Suzuki, T. &amp; Kanamori, T. <strong>Density Ratio Estimation in Machine Learning.</strong> Cambridge University Press 2012.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
