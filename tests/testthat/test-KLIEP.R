context("KLIEP")

test_that("KLIEP", {
  set.seed(1)
  x <- rnorm(200, mean = 1, sd = 1/8)
  y <- rnorm(200, mean = 1, sd = 1/2)

  result <- KLIEP(x, y)

  alpha <- result$alpha
  sigma <- result$kernel_info$sigma
  lambda <- result$lambda

  expected_alpha <- c(0.19989552888216, 0.194091742522661, 0.0190396603242885, 0, 0, 0.111847817937993, 0, 0.275314166410662, 0.250066194656671, 0.285929838278085, 0.137819427961783, 0.0497277932054529, 0.0587696724349364, 0.0556990471588486, 0.0280886116019077, 0.119198735095363, 0, 0, 0.0198476263799833, 0.0942488348644642, 0.100477427039042, 0.150254540583809, 0, 0, 0.0561974813114708, 0, 0.0104455053872225, 0.091420126224865, 0.297386672582822, 0.0704176968009879, 0.180431108569687, 0.0498880646780557, 0, 0.149986020376348, 0, 0.10860370660987, 0.0956227974781267, 0, 0, 0.0396385217890564, 0.0679684079523449, 0.144915144946574, 0.0670388839214347, 0.137411254588231, 0.136783699689613, 0, 0.102816676466153, 0, 0.298418291290289, 0, 0.0777171720746529, 0.0685150744692756, 0.147046599217944, 0, 0.069314635746898, 0.0232625096641745, 0.0955622204740962, 0.234698210911241, 0.134735788477325, 0.0616488318603178, 0.0361857386618973, 0.125197229708402, 0.099062048495542, 0.294175399053216, 0.110697147496438, 0.25170916731008, 0.288783806311547, 0, 0.159719859866478, 0, 0, 0.132440227971601, 0.0228787903548558, 0.148631210334356, 0.0547579344816517, 0.244141284803073, 0.296652868688535, 0, 0.157191473239082, 0, 0.151978392078735, 0, 0.0342978950395334, 0, 0, 0, 0.0557533450160968, 0.00633322162316586, 0, 0.0305463743430339, 0.0861514031326755, 0, 0.0629374632325391, 0, 0, 0.0983648721580112, 0.013790246251806, 0, 0, 0.048827373784507)

  expect_equal(alpha, matrix(expected_alpha))
  expect_equal(sigma, 0.19999)
})
